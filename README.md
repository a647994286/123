# PGOT: Physics-Guided Optimal Transport for Urban Traffic Flow Forecasting

PGOT æ˜¯ä¸€ä¸ªç”¨äºåŸå¸‚äº¤é€šæµé‡é¢„æµ‹çš„æ–°å‹æ¨¡å‹æ¡†æ¶ã€‚å®ƒæ˜¾å¼å»ºæ¨¡äº†å±€éƒ¨çš„ç‰©ç†è¿ç§»å…³ç³»å’Œå…¨å±€çš„æ—¶ç©ºä¾èµ–å…³ç³»ï¼Œåœ¨å¤šä¸ªçœŸå®äº¤é€šæ•°æ®é›†ä¸Šè¾¾åˆ°äº†æœ€å…ˆè¿›çš„æ€§èƒ½ã€‚

---

## ä¸€ã€é¡¹ç›®ç‰¹ç‚¹

- ğŸš¦ **å±€éƒ¨å»ºæ¨¡**ï¼šåˆ©ç”¨æœ€ä¼˜ä¼ è¾“ï¼ˆOptimal Transportï¼‰ç†è®ºæ˜¾å¼å»ºæ¨¡åŒºåŸŸé—´çš„æµåŠ¨å…³ç³»
- ğŸŒ **å…¨å±€å»ºæ¨¡**ï¼šå¼•å…¥æ—¶ç©º MLP æ¨¡å—æŒ–æ˜å…¨å±€æ—¶ç©ºä¾èµ–
- ğŸ§  **æ¨¡å—æ¸…æ™°**ï¼šåŒ…å«å±€éƒ¨å»ºæ¨¡æ¨¡å—ã€å…¨å±€ MLP æ¨¡å—ã€é—¨æ§èåˆæ¨¡å—
- ğŸ’» **æ”¯æŒå¤šæ•°æ®é›†**ï¼šé€‚ç”¨äº TaxiBJã€BikeNYCã€TaxiNYC ç­‰å¤šä¸ªäº¤é€šæ•°æ®é›†
- âš™ï¸ **æ˜“äºè®­ç»ƒ**ï¼šæ”¯æŒå¤š GPUã€AMP è®­ç»ƒï¼ŒåŠ é€Ÿå¤§è§„æ¨¡è®­ç»ƒä»»åŠ¡

---

## äºŒã€ç›®å½•ç»“æ„

```
PGOT/
â”œâ”€â”€ data/                # å­˜æ”¾äº¤é€šæ•°æ® CSV æ–‡ä»¶
â”œâ”€â”€ exp/                 # å®éªŒè¿è¡Œå…¥å£
â”‚   â””â”€â”€ exp_pgot.py
â”œâ”€â”€ models/              # æ¨¡å‹ç»“æ„å®šä¹‰
â”‚   â”œâ”€â”€ pgot.py          # ä¸»æ¨¡å‹ PGOT
â”‚   â”œâ”€â”€ attn.py          # æ³¨æ„åŠ›ä¸æ¡ä»¶æ³¨æ„åŠ›
â”‚   â”œâ”€â”€ encoder.py       # ç¼–ç å™¨ç»“æ„
â”‚   â”œâ”€â”€ embed.py         # æ—¶ç©ºåµŒå…¥æ¨¡å—
â”‚   â””â”€â”€ optionT.py       # æœ€ä¼˜ä¼ è¾“ OT æ¨¡å—
â”œâ”€â”€ utils/               # å·¥å…·åº“
â”œâ”€â”€ main.py              # ä¸»è®­ç»ƒä¸æµ‹è¯•è„šæœ¬
â””â”€â”€ requirements.txt     # Python ä¾èµ–
```

---

## ä¸‰ã€ç¯å¢ƒé…ç½®

```bash
Python >= 3.8
PyTorch >= 1.10
numpy
pandas
```
å®‰è£…æ–¹å¼ï¼š
```bash
pip install -r requirements.txt
```

---

## å››ã€è¿è¡Œç¤ºä¾‹

ä»¥ Bike1NYC æ•°æ®é›†ä¸ºä¾‹ï¼š
```bash
python main.py \
--data Bike1NYC \
--root_path ./data/ \
--data_path Bike1NYC.csv \
--seq_len 12 --label_len 0 --pred_len 12 \
--train_epochs 15
```

---

## äº”ã€å‚æ•°è¯´æ˜

| å‚æ•°å | å«ä¹‰ |
|--------|------|
| `--seq_len` | è¾“å…¥çš„å†å²æ—¶é—´æ­¥ |
| `--pred_len` | é¢„æµ‹æœªæ¥çš„æ—¶é—´æ­¥æ•° |
| `--l`, `--w` | è¾“å…¥ç©ºé—´çš„åˆ’åˆ†ç»´åº¦ï¼ˆé•¿ã€å®½ï¼‰ |
| `--d_model` | æ¨¡å‹åµŒå…¥ç»´åº¦ |
| `--e_layers` | ç¼–ç å™¨å±‚æ•° |
| `--dropout` | Dropout æ¯”ä¾‹ |
| `--use_gpu` | æ˜¯å¦ä½¿ç”¨ GPU |
| `--do_predict` | æ˜¯å¦è¿›è¡Œæœªæ¥é¢„æµ‹ |

---

## å…­ã€æ”¯æŒçš„æ•°æ®é›†

| åç§° | åŸå¸‚ | æè¿° |
|------|------|------|
| TaxiBJ   | åŒ—äº¬ | å‡ºç§Ÿè½¦äº¤é€šæµé‡ç½‘æ ¼æ•°æ® |
| TaxiNYC  | çº½çº¦ | çº½çº¦å‡ºç§Ÿè½¦æµé‡ |
| Bike1NYC | çº½çº¦ | å…¬å…±è‡ªè¡Œè½¦ç§Ÿèµæ•°æ® |
| Bike2NYC | çº½çº¦ | æ›´é«˜è´¨é‡ç‰ˆæœ¬çš„ BikeNYC |

å°†æ•°æ® CSV æ–‡ä»¶æ”¾ç½®åœ¨ `./data/` ç›®å½•ä¸‹å³å¯ã€‚

---
